<ion-header>
	<ion-toolbar>
		<ion-buttons slot="end">
			<ion-back-button></ion-back-button>
		</ion-buttons>
		<ion-title slot="start">{{base1c?.name}}</ion-title>
	</ion-toolbar>
</ion-header>

<ion-content>
	<ion-progress-bar *ngIf="isSubmittingGetPSubscribers$|async" type="indeterminate" color="primary" reversed="true"></ion-progress-bar>
	
	<ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
		<ion-refresher-content color="primary"></ion-refresher-content>
	</ion-refresher>
	
	<ion-list *ngIf="pSubscriberList.length > 0" lines="full" class="is-list-colored">
		<ion-searchbar placeholder="Search..." [(ngModel)]="searchTerm" show-cancel-button="focus"></ion-searchbar>
		<div *ngFor="let item of pSubscriberList | filter: searchTerm; let i = index">
			<ion-item [ngClass]="item.dolg <= 0 ? 'is-item-category-success' : 'is-item-category-danger'" (click)="itemTapped(i)">
				<ion-label>
					<h2>
						{{item.numContract}} / {{item.lsProm}}
						<ion-icon name="arrow-down" *ngIf="!isShown[i]"></ion-icon>
						<ion-icon name="arrow-up" *ngIf="isShown[i]"></ion-icon>
					</h2>
					<p>{{item.nameProm}}</p>
					<p>{{item.dateUpdate}}</p>
				</ion-label>
				<div slot="end" class="is-list-colored-button-group">
					<h3>{{item.dolg |number:'0.1-2'}}</h3>
				</div>
			</ion-item>
			<div class="ion-padding-horizontal">
				<ion-grid [class.is-hide]="!isShown[i] || false" class="ion-no-padding">
					<div (click)="itemTapped(i)">
						<ion-row>
							<ion-col class="hydrated">№ контракта</ion-col>
							<ion-col class="ion-text-right hydrated">
								{{item.numContract}}
							</ion-col>
						</ion-row>
						<ion-row>
							<ion-col class="hydrated">Л.с для оплаты</ion-col>
							<ion-col class="ion-text-right hydrated">
								{{item.lsProm}}
							</ion-col>
						</ion-row>
						<ion-row>
							<ion-col>
								Имя
							</ion-col>
							<ion-col class="ion-text-right">
								{{item.nameProm}}
							</ion-col>
						</ion-row>
						<ion-row>
							<ion-col>
								Адрес
							</ion-col>
							<ion-col class="ion-text-right">
								{{item.addressProm}}
							</ion-col>
						</ion-row>
						<ion-row>
							<ion-col>
								Дебит
							</ion-col>
							<ion-col class="ion-text-right">
								{{item.dolg}}
							</ion-col>
						</ion-row>
						<ion-row>
							<ion-col>
								Дата обновления
							</ion-col>
							<ion-col class="ion-text-right">
								{{item.dateUpdate}}
							</ion-col>
						</ion-row>
						<br>
					</div>
					
					<ion-row>
						<ion-col>
							<ion-item style="border-radius: 5px" button color="primary" detail="true">
								<ion-label>Точка учета</ion-label>
							</ion-item>
						</ion-col>
					</ion-row>
				</ion-grid>
			</div>
		</div>
	</ion-list>
	
	<ion-infinite-scroll threshold="100px" (ionInfinite)="loadData($event)">
		<ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Loading more data..."></ion-infinite-scroll-content>
	</ion-infinite-scroll>
</ion-content>
